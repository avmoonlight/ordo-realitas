<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Agentes — Ordo Realitas</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/agentes.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>

    <!-- BOTÃO HAMBURGUER -->
<div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
</div>

<!-- Botão de alternância de tema -->
<button id="theme-toggle" class="theme-btn">
    <i class="bi bi-moon-fill" id="theme-icon"></i>
</button>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
    <h2>Ordo Realitas</h2>

    <ul>
        <li class="active">
            <a href="{{ url_for('agentes') }}">
                <i class="fa-solid fa-brain"></i> Agentes
            </a>
        </li>
        <li>
            <a href="{{ url_for('itens') }}">
                <i class="fa-solid fa-box"></i> Itens
            </a>
        </li>
        <li>
            <a href="{{ url_for('criaturas') }}">
                <i class="fa-solid fa-dragon"></i> Criaturas
            </a>
        </li>
    </ul>

    <div class="logout-link">
        <a href="{{ url_for('logout') }}">
            <i class="fa-solid fa-right-from-bracket"></i> Sair
        </a>
    </div>
</aside>


    <!-- Conteúdo principal -->
    <div class="main-content">
        
        <h1>Gestão de Agentes C.R.I.S</h1>
        <button class="btn-novo" id="abrirModal"><i class="fa-solid fa-plus"></i> Novo Agente</button>
        <!-- BARRA DE PESQUISA (EM CIMA) -->
<!-- PESQUISA -->
<div class="pesquisa-topo">

    <label>Pesquisar por:</label>

    <div class="pesquisa-linha">
        <select id="tipoFiltro">
            <option value="nome">Nome</option>
            <option value="sobrenome">Sobrenome</option>
            <option value="elemento">Elemento</option>
            <option value="classe">Classe</option>
            <option value="ocupacao">Ocupação</option>
            <option value="marca">Marca</option>
            <option value="equipe">Equipe</option>
            <option value="status">Status</option>
        </select>

        <input type="text" id="barraPesquisa" placeholder="Buscar...">
    </div>

</div>


        <div class="usuarios-container">
            {% for agente in agentes %}
            <div class="usuario-card" 
                 data-id="{{ agente.id }}"
                 data-nome="{{ agente.nome }}"
                 data-sobrenome="{{ agente.sobrenome }}"
                 data-data_nasc="{{ agente.data_nasc }}"
                 data-contato="{{ agente.contato_emergencia }}"
                 data-elemento="{{ agente.elemento }}"
                 data-classe="{{ agente.classe }}"
                 data-ocupacao="{{ agente.ocupacao }}"
                 data-marca="{{ agente.marca }}"
                 data-equipe="{{ agente.equipe }}"
                 data-status="{{ agente.status }}"
                 data-observacoes="{{ agente.observacoes }}"
            >
                {% if agente.imagem %}
                    <img src="{{ url_for('static', filename=agente.imagem) }}?v={{ agente.id }}{{ loop.index }}" alt="{{ agente.nome }}">
                {% else %}
                    <img src="{{ url_for('static', filename='img/default_user.png') }}" alt="Sem imagem">
                {% endif %}

                <h3>{{ agente.nome }} {{ agente.sobrenome }}</h3>
                <p>Data Nasc: {{ agente.data_nasc }}</p>

                <div class="acoes">
                    <button class="editar" data-id="{{ agente.id }}"><i class="fa-solid fa-pen"></i></button>
                    <button class="excluir" data-id="{{ agente.id }}"><i class="fa-solid fa-trash"></i></button>
                </div>

                <div class="detalhes-agente">
                    <p><strong>Contato Emergência:</strong> {{ agente.contato_emergencia }}</p>
                    <p><strong>Elemento:</strong> {{ agente.elemento }}</p>
                    <p><strong>Classe:</strong> {{ agente.classe }}</p>
                    <p><strong>Ocupação:</strong> {{ agente.ocupacao }}</p>
                    <p><strong>Marca:</strong> {{ agente.marca }}</p>
                    <p><strong>Equipe:</strong> {{ agente.equipe }}</p>
                    <p><strong>Status:</strong> {{ agente.status }}</p>
                    <p><strong>Observações:</strong> {{ agente.observacoes }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Modal Novo Agente -->
    <div id="modalNovoUsuario" class="modal">
        <div class="modal-content">
            <span class="fechar">&times;</span>
            <h2>Novo Agente</h2>
            <form action="{{ url_for('agentes') }}" method="POST" enctype="multipart/form-data">
                <label>Nome:</label>
                <input type="text" name="nome" required>
                <label>Sobrenome:</label>
                <input type="text" name="sobrenome">
                <label>Data de Nascimento:</label>
                <input type="date" name="data_nasc">
                <label>Contato Emergência:</label>
                <input type="text" name="contato_emergencia">
                <label>Elemento:</label>
                <input type="text" name="elemento">
                <label>Classe:</label>
                <div class="peixe-aquario">
                    <select class="peixe-select" name="classe">
                        <option value="NULO">Nulo</option>
                            <option value="COMBATENTE">Combatente</option>
                            <option value="ESPECIALISTA">Especialista</option>
                            <option value="OCULTISTA">Ocultista</option>
                            <option value="SOBREVIVENTE">Sobrevivente</option>
                    </select>
                </div>
                <label>Ocupação:</label>
                <input type="text" name="ocupacao">
                <label>Marca:</label>
                <input type="text" name="marca">
                <label>Equipe:</label>
                <input type="text" name="equipe">
                <label>Status:</label>
                <select name="status">
                    <option value="VIVO">Vivo</option>
                    <option value="MORTO">Morto</option>
                </select>
                <label>Observações:</label>
                <input type="text" name="observacoes">
                <label>Imagem:</label>
                <input type="file" name="imagem" accept="image/*">
                <button type="submit" class="btn-salvar">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Modal Editar e Excluir (mesma lógica do usuário) -->
    <div id="modalEditarUsuario" class="modal">
        <div class="modal-content">
            <span class="fechar">&times;</span>
            <h2>Editar Agente</h2>
            <form id="formEditarUsuario" method="POST" enctype="multipart/form-data">
                <label>Nome:</label>
                <input type="text" name="nome" id="editNome" required>
                <label>Sobrenome:</label>
                <input type="text" name="sobrenome" id="editSobrenome">
                <label>Data Nascimento:</label>
                <input type="date" name="data_nasc" id="editDataNasc">
                <label>Contato Emergência:</label>
                <input type="text" name="contato_emergencia" id="editContato">
                <label>Elemento:</label>
                <input type="text" name="elemento" id="editElemento">
                <label>Classe:</label>
                    <div class="peixe-aquario">
                        <select name="classe" class="peixe-select" id="editClasse">
                            <option value="NULO">Nulo</option>
                            <option value="COMBATENTE">Combatente</option>
                            <option value="ESPECIALISTA">Especialista</option>
                            <option value="OCULTISTA">Ocultista</option>
                            <option value="SOBREVIVENTE">Sobrevivente</option>
                            
                        </select>
                    </div>
                <label>Ocupação:</label>
                <input type="text" name="ocupacao" id="editOcupacao">
                <label>Marca:</label>
                <input type="text" name="marca" id="editMarca">
                <label>Equipe:</label>
                <input type="text" name="equipe" id="editEquipe">
                <label>Status:</label>
                <select name="status" id="editStatus">
                    <option value="VIVO">Vivo</option>
                    <option value="MORTO">Morto</option>
                </select>
                <label>Observações:</label>
                <input type="text" name="observacoes" id="editObservacoes">
                <label>Imagem:</label>
                <input type="file" name="imagem" accept="image/*">
                <button type="submit" class="btn-salvar">Atualizar</button>
            </form>
        </div>
    </div>

    <div id="modalExcluirUsuario" class="modal">
        <div class="modal-content">
            <span class="fechar">&times;</span>
            <h2>Confirmar Exclusão</h2>
            <p>Tem certeza que deseja excluir este agente?</p>
            <form id="formExcluirUsuario" method="POST">
                <button type="submit" class="btn-salvar" style="background:#e74c3c;">Confirmar</button>
            </form>
        </div>
    </div>

    <!-- Modal Detalhes Agente -->
<div id="modalDetalhesAgente" class="modal modal-detalhes">
    <div class="modal-content">
        <span class="fechar">&times;</span>
        <h2 id="detalheNome"></h2>
        <p><strong>Data Nascimento:</strong> <span id="detalheData"></span></p>
        <p><strong>Contato Emergência:</strong> <span id="detalheContato"></span></p>
        <p><strong>Elemento:</strong> <span id="detalheElemento"></span></p>
        <p><strong>Classe:</strong> <span id="detalheClasse"></span></p>
        <p><strong>Ocupação:</strong> <span id="detalheOcupacao"></span></p>
        <p><strong>Marca:</strong> <span id="detalheMarca"></span></p>
        <p><strong>Equipe:</strong> <span id="detalheEquipe"></span></p>
        <p><strong>Status:</strong> <span id="detalheStatus"></span></p>
        <p><strong>Observações:</strong> <span id="detalheObservacoes"></span></p>
        <div class="acoes">
            <button class="editar" id="detalheEditar"><i class="fa-solid fa-pen"></i> Editar</button>
            <button class="excluir" id="detalheExcluir"><i class="fa-solid fa-trash"></i> Excluir</button>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/theme.js') }}"></script>
    <script src="{{ url_for('static', filename='js/modal-agentes.js') }}"></script>

</body>
</html>
